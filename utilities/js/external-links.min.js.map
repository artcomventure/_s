{"version":3,"file":"external-links.min.js","names":["Behaviours","add","$context","regexp","RegExp","location","host","$links","querySelectorAll","tagName","hasAttribute","push","forEach","$link","closest","addEventListener","e","stopPropagation","test","href","setAttribute","dataHref","getAttribute","window","open","key","dispatchEvent","Event","call","$a"],"sources":["external-links.js"],"sourcesContent":["/**\n * Open external links in new window.\n *\n * Also add link UX to none `<a>` elements by setting `data-href` attribute.\n */\n\nBehaviours.add( 'link:external', $context => {\n    // regexp for internal link\n    const regexp = new RegExp( '^(\\/$|\\/[^\\/]|#|((ht|f)tps?:)?\\/\\/' + location.host + '|javascript:)' );\n\n    const $links = $context.querySelectorAll( 'a, [data-href]' );\n    if ( ($context.tagName||'') === 'A' || (!!$context.hasAttribute && $context.hasAttribute( 'data-href' )) )\n        $links.push( $context );\n\n    $links.forEach(function ( $link ) {\n        if ( $link.closest( '[data-href]' ) )\n            $link.addEventListener( 'click', function ( e ) {\n                e.stopPropagation();\n            }, false );\n\n        if ( $link.tagName === 'A' ) {\n            // internal\n            if ( regexp.test( $link.href ) ) return;\n\n            if ( !$link.hasAttribute( 'rel' ) )\n                $link.setAttribute( 'rel', 'noopener noreferrer' );\n        }\n        else {\n            // let fake links ([data-href]) behave like their `<a>`\n            const dataHref = $link.getAttribute( 'data-href' );\n\n            if ( dataHref ) {\n                if ( !$link.hasAttribute( 'role' ) ) $link.setAttribute( 'role', 'link' );\n                if ( !$link.hasAttribute( 'tabindex' ) ) $link.setAttribute( 'tabindex', 0 );\n\n                $link.addEventListener( 'click', function () {\n                    window.open( dataHref, $link.getAttribute( 'target') || '_self' );\n                }, false );\n\n                // redirect on enter\n                $link.addEventListener( 'keydown', e => {\n                    if ( e.key !== 'Enter' ) return;\n                    $link.dispatchEvent( new Event( 'click' ) );\n                }, false );\n\n                // remove same inner links from tab navigations\n                [].forEach.call( $link.querySelectorAll( 'a, [data-href]' ), $a => {\n                    if ( dataHref !== $a.href ) return;\n                    if ( !$a.hasAttribute( 'tabindex' ) ) $a.setAttribute( 'tabindex', -1 );\n                } )\n            }\n\n            if ( regexp.test( $link.getAttribute( 'data-href' ) ) ) return;\n        }\n\n        // open external links in new window\n        if ( !$link.getAttribute( 'target' ) )\n            $link.setAttribute( 'target', '_blank' );\n    } );\n} );"],"mappings":";;AAAA;AACA;AACA;AACA;AACA;;AAEAA,UAAU,CAACC,GAAG,CAAE,eAAe,EAAE,UAAAC,QAAQ,EAAI;EACzC;EACA,IAAMC,MAAM,GAAG,IAAIC,MAAM,CAAE,oCAAoC,GAAGC,QAAQ,CAACC,IAAI,GAAG,eAAgB,CAAC;EAEnG,IAAMC,MAAM,GAAGL,QAAQ,CAACM,gBAAgB,CAAE,gBAAiB,CAAC;EAC5D,IAAK,CAACN,QAAQ,CAACO,OAAO,IAAE,EAAE,MAAM,GAAG,IAAK,CAAC,CAACP,QAAQ,CAACQ,YAAY,IAAIR,QAAQ,CAACQ,YAAY,CAAE,WAAY,CAAE,EACpGH,MAAM,CAACI,IAAI,CAAET,QAAS,CAAC;EAE3BK,MAAM,CAACK,OAAO,CAAC,UAAWC,KAAK,EAAG;IAC9B,IAAKA,KAAK,CAACC,OAAO,CAAE,aAAc,CAAC,EAC/BD,KAAK,CAACE,gBAAgB,CAAE,OAAO,EAAE,UAAWC,CAAC,EAAG;MAC5CA,CAAC,CAACC,eAAe,CAAC,CAAC;IACvB,CAAC,EAAE,KAAM,CAAC;IAEd,IAAKJ,KAAK,CAACJ,OAAO,KAAK,GAAG,EAAG;MACzB;MACA,IAAKN,MAAM,CAACe,IAAI,CAAEL,KAAK,CAACM,IAAK,CAAC,EAAG;MAEjC,IAAK,CAACN,KAAK,CAACH,YAAY,CAAE,KAAM,CAAC,EAC7BG,KAAK,CAACO,YAAY,CAAE,KAAK,EAAE,qBAAsB,CAAC;IAC1D,CAAC,MACI;MACD;MACA,IAAMC,QAAQ,GAAGR,KAAK,CAACS,YAAY,CAAE,WAAY,CAAC;MAElD,IAAKD,QAAQ,EAAG;QACZ,IAAK,CAACR,KAAK,CAACH,YAAY,CAAE,MAAO,CAAC,EAAGG,KAAK,CAACO,YAAY,CAAE,MAAM,EAAE,MAAO,CAAC;QACzE,IAAK,CAACP,KAAK,CAACH,YAAY,CAAE,UAAW,CAAC,EAAGG,KAAK,CAACO,YAAY,CAAE,UAAU,EAAE,CAAE,CAAC;QAE5EP,KAAK,CAACE,gBAAgB,CAAE,OAAO,EAAE,YAAY;UACzCQ,MAAM,CAACC,IAAI,CAAEH,QAAQ,EAAER,KAAK,CAACS,YAAY,CAAE,QAAQ,CAAC,IAAI,OAAQ,CAAC;QACrE,CAAC,EAAE,KAAM,CAAC;;QAEV;QACAT,KAAK,CAACE,gBAAgB,CAAE,SAAS,EAAE,UAAAC,CAAC,EAAI;UACpC,IAAKA,CAAC,CAACS,GAAG,KAAK,OAAO,EAAG;UACzBZ,KAAK,CAACa,aAAa,CAAE,IAAIC,KAAK,CAAE,OAAQ,CAAE,CAAC;QAC/C,CAAC,EAAE,KAAM,CAAC;;QAEV;QACA,EAAE,CAACf,OAAO,CAACgB,IAAI,CAAEf,KAAK,CAACL,gBAAgB,CAAE,gBAAiB,CAAC,EAAE,UAAAqB,EAAE,EAAI;UAC/D,IAAKR,QAAQ,KAAKQ,EAAE,CAACV,IAAI,EAAG;UAC5B,IAAK,CAACU,EAAE,CAACnB,YAAY,CAAE,UAAW,CAAC,EAAGmB,EAAE,CAACT,YAAY,CAAE,UAAU,EAAE,CAAC,CAAE,CAAC;QAC3E,CAAE,CAAC;MACP;MAEA,IAAKjB,MAAM,CAACe,IAAI,CAAEL,KAAK,CAACS,YAAY,CAAE,WAAY,CAAE,CAAC,EAAG;IAC5D;;IAEA;IACA,IAAK,CAACT,KAAK,CAACS,YAAY,CAAE,QAAS,CAAC,EAChCT,KAAK,CAACO,YAAY,CAAE,QAAQ,EAAE,QAAS,CAAC;EAChD,CAAE,CAAC;AACP,CAAE,CAAC"}