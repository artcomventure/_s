"use strict";function _typeof(a){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},_typeof(a)}function _slicedToArray(a,b){return _arrayWithHoles(a)||_iterableToArrayLimit(a,b)||_unsupportedIterableToArray(a,b)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(a,b){if(a){if("string"==typeof a)return _arrayLikeToArray(a,b);var c=Object.prototype.toString.call(a).slice(8,-1);return"Object"===c&&a.constructor&&(c=a.constructor.name),"Map"===c||"Set"===c?Array.from(a):"Arguments"===c||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c)?_arrayLikeToArray(a,b):void 0}}function _arrayLikeToArray(a,b){(null==b||b>a.length)&&(b=a.length);for(var c=0,d=Array(b);c<b;c++)d[c]=a[c];return d}function _iterableToArrayLimit(b,c){var d=null==b?null:"undefined"!=typeof Symbol&&b[Symbol.iterator]||b["@@iterator"];if(null!=d){var g,h,j,k,l=[],a=!0,m=!1;try{if(j=(d=d.call(b)).next,0===c){if(Object(d)!==d)return;a=!1}else for(;!(a=(g=j.call(d)).done)&&(l.push(g.value),l.length!==c);a=!0);}catch(a){m=!0,h=a}finally{try{if(!a&&null!=d["return"]&&(k=d["return"](),Object(k)!==k))return}finally{if(m)throw h}}return l}}function _arrayWithHoles(a){if(Array.isArray(a))return a}function ownKeys(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(a);b&&(d=d.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable})),c.push.apply(c,d)}return c}function _objectSpread(a){for(var b,c=1;c<arguments.length;c++)b=null==arguments[c]?{}:arguments[c],c%2?ownKeys(Object(b),!0).forEach(function(c){_defineProperty(a,c,b[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(b)):ownKeys(Object(b)).forEach(function(c){Object.defineProperty(a,c,Object.getOwnPropertyDescriptor(b,c))});return a}function _defineProperty(a,b,c){return b=_toPropertyKey(b),b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function _toPropertyKey(a){var b=_toPrimitive(a,"string");return"symbol"===_typeof(b)?b:b+""}function _toPrimitive(a,b){if("object"!==_typeof(a)||null===a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var d=c.call(a,b||"default");if("object"!==_typeof(d))return d;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===b?String:Number)(a)}(function(){"use strict";var f=window.React,e=window.wp.i18n,b=window.wp.hooks,j=window.wp.element,k=window.wp.blockEditor,a=window.wp.components,g=window.wp.compose,h=window.wp.data,l=["core/image"],i=(0,g.createHigherOrderComponent)(function(o){return function(i){if(!l.includes(i.name))return(0,f.createElement)(o,_objectSpread({},i));var n=i.attributes,q=i.setAttributes,c=i.isSelected,d=n.width,p=n.height,m=n.url,r=n.aspectRatio,s=n.focalPoint,h=(r||"/").split("/"),t=_slicedToArray(h,2),u=t[0],g=t[1],v=(0,f.useState)(s),w=_slicedToArray(v,2),y=w[0],b=w[1],z=d&&"auto"!==d&&p;return(0,f.createElement)(j.Fragment,null,(0,f.createElement)(o,_objectSpread({},i)),c&&r&&(0,f.createElement)(k.InspectorControls,null,(0,f.createElement)(a.PanelBody,{className:"aspect-ratio-settings"},(0,f.createElement)("p",{className:"label"},(0,e.__)("Aspect ratio")),(0,f.createElement)(a.Flex,{style:{paddingBottom:"8px"}},(0,f.createElement)(a.FlexItem,null,(0,f.createElement)(a.__experimentalNumberControl,{placeholder:(0,e.__)("Width"),value:u,disabled:z,spinControls:"none",onChange:function onChange(a){q({aspectRatio:"".concat(a,"/").concat(g)})}})),(0,f.createElement)(a.FlexItem,{style:{paddingBottom:"8px"}},"/"),(0,f.createElement)(a.FlexItem,null,(0,f.createElement)(a.__experimentalNumberControl,{placeholder:(0,e.__)("Height"),value:g,disabled:z,spinControls:"none",onChange:function onChange(a){q({aspectRatio:"".concat(u,"/").concat(a)})}}))),(0,f.createElement)(a.FocalPointPicker,{__nextHasNoMarginBottom:!0,label:(0,e.__)("Set focal point","aspect-ratio"),url:m,value:s,onDragStart:function onDragStart(a){q({focalPoint:a}),b(a)},onDrag:function onDrag(a){q({focalPoint:a}),b(a)},onChange:function onChange(a){q({focalPoint:a}),b(a)}}))))}},"withAdvancedControls");(0,b.addFilter)("blocks.registerBlockType","utilities/aspect-ratio",function(a,b){return l.includes(b)&&(a=_objectSpread(_objectSpread({},a),{},{attributes:_objectSpread(_objectSpread({},a.attributes),{},{focalPoint:{type:"object",default:{x:.5,y:.5}}})})),a}),(0,b.addFilter)("editor.BlockEdit","utilities/aspect-ratio-control",i),(0,b.addFilter)("blocks.getSaveContent.extraProps","utilities/applyAspectRatioAttribute",function(a,b,c){if(l.includes(b.name)){var d=c.width,f=c.height,g=c.aspectRatio,h=c.focalPoint;g&&(d&&"auto"!==d&&f||.5===h.x&&.5===h.y||(a=_objectSpread(_objectSpread({},a),{},{"data-object-position":"".concat(100*h.x,"% ").concat(100*h.y,"%")})))}return a});var c=(0,g.createHigherOrderComponent)(function(a){return function(b){if(l.includes(b.name)){var c=document.querySelector("#block-".concat(b.clientId," img"));if(c){var d=b.attributes,e=d.width,g=d.height,h=d.aspectRatio,i=d.scale,j=d.focalPoint;c.style.aspectRatio="",c.style.objectFit="",c.style.objectPosition="",c.style.width="",c.style.height="",c.parentElement.style.height="",c.nextElementSibling&&(c.nextElementSibling.style.display=""),h&&(e&&"auto"!==e&&g||window.requestAnimationFrame(function(){c.style.aspectRatio=h,c.style.objectFit=i||"cover",c.style.objectPosition="".concat(100*j.x,"% ").concat(100*j.y,"%"),"auto"===e?(c.style.width="",c.parentElement.style.width=""):(c.style.width=e||"100%",c.style.height="auto",c.parentElement.style.height="auto"),c.nextElementSibling&&(c.nextElementSibling.style.display="none")}))}}return(0,f.createElement)(a,_objectSpread({},b))}},"aspectRatioPreview");wp.hooks.addFilter("editor.BlockListBlock","utilities/aspect-ratio-preview",c),(0,b.addFilter)("blockEditor.useSetting.before","utilities/aspect-ratio-select",function(b,c,d,f){if("core/image"===f&&"dimensions.aspectRatios.theme"===c){var a=(0,h.select)("core/block-editor").getBlockAttributes(d);b=[{name:(0,e.__)("Manually","aspect-ratio"),slug:"manually",ratio:a.aspectRatio||"/"}]}return b})})();